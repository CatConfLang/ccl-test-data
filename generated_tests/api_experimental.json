{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "tests": [
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "database.host",
            "value": "localhost"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "database.host = localhost",
      "name": "basic_dotted_key_expansion_parse",
      "source_test": "basic_dotted_key_expansion",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "database",
            "value": "\n  host = localhost"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "database.host = localhost",
      "name": "basic_dotted_key_expansion_expand_dotted",
      "source_test": "basic_dotted_key_expansion",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "database": {
            "host": "localhost"
          }
        }
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "database.host = localhost",
      "name": "basic_dotted_key_expansion_build_hierarchy",
      "source_test": "basic_dotted_key_expansion",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 3,
        "entries": [
          {
            "key": "database.host",
            "value": "localhost"
          },
          {
            "key": "database.port",
            "value": "5432"
          },
          {
            "key": "app.name",
            "value": "MyApp"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "database.host = localhost\ndatabase.port = 5432\napp.name = MyApp",
      "name": "multiple_dotted_keys_parse",
      "source_test": "multiple_dotted_keys",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 2,
        "entries": [
          {
            "key": "database",
            "value": "\n  host = localhost\n  port = 5432"
          },
          {
            "key": "app",
            "value": "\n  name = MyApp"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "database.host = localhost\ndatabase.port = 5432\napp.name = MyApp",
      "name": "multiple_dotted_keys_expand_dotted",
      "source_test": "multiple_dotted_keys",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "app": {
            "name": "MyApp"
          },
          "database": {
            "host": "localhost",
            "port": "5432"
          }
        }
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "database.host = localhost\ndatabase.port = 5432\napp.name = MyApp",
      "name": "multiple_dotted_keys_build_hierarchy",
      "source_test": "multiple_dotted_keys",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 2,
        "entries": [
          {
            "key": "server.database.credentials.user",
            "value": "admin"
          },
          {
            "key": "server.database.credentials.pass",
            "value": "secret"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "server.database.credentials.user = admin\nserver.database.credentials.pass = secret",
      "name": "deep_dotted_nesting_parse",
      "source_test": "deep_dotted_nesting",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "server",
            "value": "\n  database =\n    credentials =\n      user = admin\n      pass = secret"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "server.database.credentials.user = admin\nserver.database.credentials.pass = secret",
      "name": "deep_dotted_nesting_expand_dotted",
      "source_test": "deep_dotted_nesting",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "server": {
            "database": {
              "credentials": {
                "pass": "secret",
                "user": "admin"
              }
            }
          }
        }
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "server.database.credentials.user = admin\nserver.database.credentials.pass = secret",
      "name": "deep_dotted_nesting_build_hierarchy",
      "source_test": "deep_dotted_nesting",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 4,
        "entries": [
          {
            "key": "app",
            "value": "MyApp"
          },
          {
            "key": "database.host",
            "value": "localhost"
          },
          {
            "key": "config",
            "value": "\n  debug = true"
          },
          {
            "key": "logging.level",
            "value": "info"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "app = MyApp\ndatabase.host = localhost\nconfig =\n  debug = true\nlogging.level = info",
      "name": "mixed_dotted_and_regular_keys_parse",
      "source_test": "mixed_dotted_and_regular_keys",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 4,
        "entries": [
          {
            "key": "app",
            "value": "MyApp"
          },
          {
            "key": "database",
            "value": "\n  host = localhost"
          },
          {
            "key": "config",
            "value": "\n  debug = true"
          },
          {
            "key": "logging",
            "value": "\n  level = info"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "app = MyApp\ndatabase.host = localhost\nconfig =\n  debug = true\nlogging.level = info",
      "name": "mixed_dotted_and_regular_keys_expand_dotted",
      "source_test": "mixed_dotted_and_regular_keys",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "app": "MyApp",
          "config": {
            "debug": "true"
          },
          "database": {
            "host": "localhost"
          },
          "logging": {
            "level": "info"
          }
        }
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "app = MyApp\ndatabase.host = localhost\nconfig =\n  debug = true\nlogging.level = info",
      "name": "mixed_dotted_and_regular_keys_build_hierarchy",
      "source_test": "mixed_dotted_and_regular_keys",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 2,
        "entries": [
          {
            "key": "database",
            "value": "old_value"
          },
          {
            "key": "database.host",
            "value": "localhost"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "database = old_value\ndatabase.host = localhost",
      "name": "dotted_key_conflicts_resolution_parse",
      "source_test": "dotted_key_conflicts_resolution",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "database",
            "value": "\n  host = localhost"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "database = old_value\ndatabase.host = localhost",
      "name": "dotted_key_conflicts_resolution_expand_dotted",
      "source_test": "dotted_key_conflicts_resolution",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "database": {
            "host": "localhost"
          }
        }
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "database = old_value\ndatabase.host = localhost",
      "name": "dotted_key_conflicts_resolution_build_hierarchy",
      "source_test": "dotted_key_conflicts_resolution",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 3,
        "entries": [
          {
            "key": "servers.web",
            "value": "web1"
          },
          {
            "key": "servers.web",
            "value": "web2"
          },
          {
            "key": "servers.api",
            "value": "api1"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "servers.web = web1\nservers.web = web2\nservers.api = api1",
      "name": "dotted_keys_with_lists_parse",
      "source_test": "dotted_keys_with_lists",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "servers",
            "value": "\n  web = web1\n  web = web2\n  api = api1"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "servers.web = web1\nservers.web = web2\nservers.api = api1",
      "name": "dotted_keys_with_lists_expand_dotted",
      "source_test": "dotted_keys_with_lists",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "servers": {
            "api": "api1",
            "web": [
              "web1",
              "web2"
            ]
          }
        }
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "servers.web = web1\nservers.web = web2\nservers.api = api1",
      "name": "dotted_keys_with_lists_build_hierarchy",
      "source_test": "dotted_keys_with_lists",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "a..b",
            "value": "value"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "empty_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "a..b = value",
      "name": "empty_dotted_key_segments_parse",
      "source_test": "empty_dotted_key_segments",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "a",
            "value": "\n   =\n    b = value"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "empty_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "a..b = value",
      "name": "empty_dotted_key_segments_expand_dotted",
      "source_test": "empty_dotted_key_segments",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "a": {
            "": {
              "b": "value"
            }
          }
        }
      },
      "features": [
        "experimental_dotted_keys",
        "empty_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "a..b = value",
      "name": "empty_dotted_key_segments_build_hierarchy",
      "source_test": "empty_dotted_key_segments",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "a.",
            "value": "value"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "empty_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "a. = value",
      "name": "single_dot_key_parse",
      "source_test": "single_dot_key",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "a",
            "value": "\n   = value"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "empty_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "a. = value",
      "name": "single_dot_key_expand_dotted",
      "source_test": "single_dot_key",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "a": {
            "": "value"
          }
        }
      },
      "features": [
        "experimental_dotted_keys",
        "empty_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "a. = value",
      "name": "single_dot_key_build_hierarchy",
      "source_test": "single_dot_key",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "entries": [
          {
            "key": "database",
            "value": "\n  enabled = true\n  port = 5432"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "database =\n  enabled = true\n  port = 5432",
      "name": "hierarchical_with_expand_dotted_validation_parse",
      "source_test": "hierarchical_with_expand_dotted_validation",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 3,
        "entries": [
          {
            "key": "database",
            "value": ""
          },
          {
            "key": "database.enabled",
            "value": "true"
          },
          {
            "key": "database.port",
            "value": "5432"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys",
        "experimental_dotted_keys"
      ],
      "functions": [
        "expand_dotted"
      ],
      "input": "database =\n  enabled = true\n  port = 5432",
      "name": "hierarchical_with_expand_dotted_validation_expand_dotted",
      "source_test": "hierarchical_with_expand_dotted_validation",
      "validation": "expand_dotted",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "database": {
            "enabled": "true",
            "port": "5432"
          }
        }
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "database =\n  enabled = true\n  port = 5432",
      "name": "hierarchical_with_expand_dotted_validation_build_hierarchy",
      "source_test": "hierarchical_with_expand_dotted_validation",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 3,
        "entries": [
          {
            "key": "database.hosts",
            "value": "primary"
          },
          {
            "key": "database.hosts",
            "value": "secondary"
          },
          {
            "key": "database.port",
            "value": "5432"
          }
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "parse"
      ],
      "input": "database.hosts = primary\ndatabase.hosts = secondary\ndatabase.port = 5432",
      "name": "dotted_key_list_access_parse",
      "source_test": "dotted_key_list_access",
      "validation": "parse",
      "variants": []
    },
    {
      "behaviors": [],
      "expected": {
        "count": 1,
        "object": {
          "database": {
            "hosts": [
              "primary",
              "secondary"
            ],
            "port": "5432"
          }
        }
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "build_hierarchy"
      ],
      "input": "database.hosts = primary\ndatabase.hosts = secondary\ndatabase.port = 5432",
      "name": "dotted_key_list_access_build_hierarchy",
      "source_test": "dotted_key_list_access",
      "validation": "build_hierarchy",
      "variants": []
    },
    {
      "args": [
        "database",
        "port"
      ],
      "behaviors": [],
      "expected": {
        "count": 1,
        "list": [
          "5432"
        ]
      },
      "features": [
        "experimental_dotted_keys"
      ],
      "functions": [
        "get_list"
      ],
      "input": "database.hosts = primary\ndatabase.hosts = secondary\ndatabase.port = 5432",
      "name": "dotted_key_list_access_get_list",
      "source_test": "dotted_key_list_access",
      "validation": "get_list",
      "variants": []
    }
  ]
}