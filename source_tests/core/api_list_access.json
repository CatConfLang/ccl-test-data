{
  "$schema": "../../schemas/source-format.json",
  "tests": [
    {
      "name": "basic_list_from_duplicates",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "servers",
              "value": "web1"
            },
            {
              "key": "servers",
              "value": "web2"
            },
            {
              "key": "servers",
              "value": "web3"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "servers": [
              "web1",
              "web2",
              "web3"
            ]
          }
        },
        {
          "function": "get_list",
          "expect": [
            "web1",
            "web2",
            "web3"
          ],
          "args": [
            "servers"
          ]
        }
      ],
      "behaviors": [
        "list_coercion_enabled"
      ],
      "inputs": [
        "servers = web1\nservers = web2\nservers = web3"
      ]
    },
    {
      "name": "large_list",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "items",
              "value": "item01"
            },
            {
              "key": "items",
              "value": "item02"
            },
            {
              "key": "items",
              "value": "item03"
            },
            {
              "key": "items",
              "value": "item04"
            },
            {
              "key": "items",
              "value": "item05"
            },
            {
              "key": "items",
              "value": "item06"
            },
            {
              "key": "items",
              "value": "item07"
            },
            {
              "key": "items",
              "value": "item08"
            },
            {
              "key": "items",
              "value": "item09"
            },
            {
              "key": "items",
              "value": "item10"
            },
            {
              "key": "items",
              "value": "item11"
            },
            {
              "key": "items",
              "value": "item12"
            },
            {
              "key": "items",
              "value": "item13"
            },
            {
              "key": "items",
              "value": "item14"
            },
            {
              "key": "items",
              "value": "item15"
            },
            {
              "key": "items",
              "value": "item16"
            },
            {
              "key": "items",
              "value": "item17"
            },
            {
              "key": "items",
              "value": "item18"
            },
            {
              "key": "items",
              "value": "item19"
            },
            {
              "key": "items",
              "value": "item20"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "items": [
              "item01",
              "item02",
              "item03",
              "item04",
              "item05",
              "item06",
              "item07",
              "item08",
              "item09",
              "item10",
              "item11",
              "item12",
              "item13",
              "item14",
              "item15",
              "item16",
              "item17",
              "item18",
              "item19",
              "item20"
            ]
          }
        },
        {
          "function": "get_list",
          "expect": [
            "item01",
            "item02",
            "item03",
            "item04",
            "item05",
            "item06",
            "item07",
            "item08",
            "item09",
            "item10",
            "item11",
            "item12",
            "item13",
            "item14",
            "item15",
            "item16",
            "item17",
            "item18",
            "item19",
            "item20"
          ],
          "args": [
            "items"
          ]
        }
      ],
      "behaviors": [
        "list_coercion_enabled"
      ],
      "inputs": [
        "items = item01\nitems = item02\nitems = item03\nitems = item04\nitems = item05\nitems = item06\nitems = item07\nitems = item08\nitems = item09\nitems = item10\nitems = item11\nitems = item12\nitems = item13\nitems = item14\nitems = item15\nitems = item16\nitems = item17\nitems = item18\nitems = item19\nitems = item20"
      ]
    },
    {
      "name": "list_with_comments",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "servers",
              "value": "web1"
            },
            {
              "key": "/",
              "value": "Production servers"
            },
            {
              "key": "servers",
              "value": "web2"
            },
            {
              "key": "servers",
              "value": "web3"
            },
            {
              "key": "/",
              "value": "End of list"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "/": [
              "Production servers",
              "End of list"
            ],
            "servers": [
              "web1",
              "web2",
              "web3"
            ]
          }
        },
        {
          "function": "get_list",
          "expect": [
            "web1",
            "web2",
            "web3"
          ],
          "args": [
            "servers"
          ]
        }
      ],
      "behaviors": [
        "list_coercion_enabled",
        "array_order_insertion"
      ],
      "features": [
        "comments"
      ],
      "inputs": [
        "servers = web1\n/= Production servers\nservers = web2\nservers = web3\n/= End of list"
      ]
    },
    {
      "name": "list_with_comments_lexicographic",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "servers",
              "value": "web1"
            },
            {
              "key": "/",
              "value": "Production servers"
            },
            {
              "key": "servers",
              "value": "web2"
            },
            {
              "key": "servers",
              "value": "web3"
            },
            {
              "key": "/",
              "value": "End of list"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "/": [
              "End of list",
              "Production servers"
            ],
            "servers": [
              "web1",
              "web2",
              "web3"
            ]
          }
        },
        {
          "function": "get_list",
          "expect": [
            "web1",
            "web2",
            "web3"
          ],
          "args": [
            "servers"
          ]
        }
      ],
      "behaviors": [
        "list_coercion_enabled",
        "array_order_lexicographic"
      ],
      "features": [
        "comments"
      ],
      "inputs": [
        "servers = web1\n/= Production servers\nservers = web2\nservers = web3\n/= End of list"
      ]
    },
    {
      "name": "list_error_missing_key",
      "tests": [
        {
          "function": "build_hierarchy",
          "expect": {
            "existing": "value"
          }
        },
        {
          "function": "get_list",
          "expect": null,
          "args": [
            "missing"
          ]
        },
        {
          "function": "parse",
          "expect": [
            {
              "key": "existing",
              "value": "value"
            }
          ]
        }
      ],
      "inputs": [
        "existing = value"
      ]
    },
    {
      "name": "list_error_nested_missing_key",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "config",
              "value": "\n  server = web1"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "config": {
              "server": "web1"
            }
          }
        },
        {
          "function": "get_list",
          "expect": null,
          "args": [
            "config",
            "missing"
          ]
        }
      ],
      "inputs": [
        "config =\n  server = web1"
      ]
    },
    {
      "name": "list_error_non_object_path",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "value",
              "value": "simple"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "value": "simple"
          }
        },
        {
          "function": "get_list",
          "expect": null,
          "args": [
            "value",
            "nested"
          ]
        }
      ],
      "inputs": [
        "value = simple"
      ]
    },
    {
      "name": "list_edge_case_zero_length",
      "tests": [
        {
          "function": "get_list",
          "expect": null,
          "args": [
            "nonexistent"
          ]
        },
        {
          "function": "parse",
          "expect": []
        },
        {
          "function": "build_hierarchy",
          "expect": {}
        }
      ],
      "inputs": [
        ""
      ]
    },
    {
      "name": "bare_list_basic",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "servers",
              "value": "\n  = web1\n  = web2\n  = web3"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "servers": {
              "": [
                "web1",
                "web2",
                "web3"
              ]
            }
          }
        },
        {
          "function": "get_list",
          "expect": [
            "web1",
            "web2",
            "web3"
          ],
          "args": [
            "servers"
          ]
        }
      ],
      "features": [
        "empty_keys"
      ],
      "inputs": [
        "servers =\n  = web1\n  = web2\n  = web3"
      ]
    },
    {
      "name": "bare_list_nested",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "network",
              "value": "\n  ports =\n    = 80\n    = 443\n    = 8080"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "network": {
              "ports": {
                "": [
                  "80",
                  "443",
                  "8080"
                ]
              }
            }
          }
        },
        {
          "function": "get_list",
          "expect": [
            "80",
            "443",
            "8080"
          ],
          "args": [
            "network",
            "ports"
          ]
        }
      ],
      "features": [
        "empty_keys"
      ],
      "behaviors": [
        "array_order_insertion"
      ],
      "inputs": [
        "network =\n  ports =\n    = 80\n    = 443\n    = 8080"
      ]
    },
    {
      "name": "bare_list_nested_lexicographic",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "network",
              "value": "\n  ports =\n    = 80\n    = 443\n    = 8080"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "network": {
              "ports": {
                "": [
                  "443",
                  "80",
                  "8080"
                ]
              }
            }
          }
        },
        {
          "function": "get_list",
          "expect": [
            "443",
            "80",
            "8080"
          ],
          "args": [
            "network",
            "ports"
          ]
        }
      ],
      "features": [
        "empty_keys"
      ],
      "behaviors": [
        "array_order_lexicographic"
      ],
      "inputs": [
        "network =\n  ports =\n    = 80\n    = 443\n    = 8080"
      ]
    },
    {
      "name": "bare_list_with_comments",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "allowed_hosts",
              "value": "\n  /= Production hosts\n  = localhost\n  = 127.0.0.1\n  = example.com"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "allowed_hosts": {
              "": [
                "localhost",
                "127.0.0.1",
                "example.com"
              ],
              "/": "Production hosts"
            }
          }
        },
        {
          "function": "get_list",
          "expect": [
            "localhost",
            "127.0.0.1",
            "example.com"
          ],
          "args": [
            "allowed_hosts"
          ]
        }
      ],
      "features": [
        "empty_keys",
        "comments"
      ],
      "behaviors": [
        "array_order_insertion"
      ],
      "inputs": [
        "allowed_hosts =\n  /= Production hosts\n  = localhost\n  = 127.0.0.1\n  = example.com"
      ]
    },
    {
      "name": "bare_list_with_comments_lexicographic",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "allowed_hosts",
              "value": "\n  /= Production hosts\n  = localhost\n  = 127.0.0.1\n  = example.com"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "allowed_hosts": {
              "": [
                "127.0.0.1",
                "example.com",
                "localhost"
              ],
              "/": "Production hosts"
            }
          }
        },
        {
          "function": "get_list",
          "expect": [
            "127.0.0.1",
            "example.com",
            "localhost"
          ],
          "args": [
            "allowed_hosts"
          ]
        }
      ],
      "features": [
        "empty_keys",
        "comments"
      ],
      "behaviors": [
        "array_order_lexicographic"
      ],
      "inputs": [
        "allowed_hosts =\n  /= Production hosts\n  = localhost\n  = 127.0.0.1\n  = example.com"
      ]
    },
    {
      "name": "bare_list_deeply_nested",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "config",
              "value": "\n  environments =\n    production =\n      servers =\n        = web1\n        = web2\n        = api1"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "config": {
              "environments": {
                "production": {
                  "servers": {
                    "": [
                      "web1",
                      "web2",
                      "api1"
                    ]
                  }
                }
              }
            }
          }
        },
        {
          "function": "get_list",
          "expect": [
            "web1",
            "web2",
            "api1"
          ],
          "args": [
            "config",
            "environments",
            "production",
            "servers"
          ]
        }
      ],
      "features": [
        "empty_keys"
      ],
      "behaviors": [
        "array_order_insertion"
      ],
      "inputs": [
        "config =\n  environments =\n    production =\n      servers =\n        = web1\n        = web2\n        = api1"
      ]
    },
    {
      "name": "bare_list_deeply_nested_lexicographic",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "config",
              "value": "\n  environments =\n    production =\n      servers =\n        = web1\n        = web2\n        = api1"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "config": {
              "environments": {
                "production": {
                  "servers": {
                    "": [
                      "api1",
                      "web1",
                      "web2"
                    ]
                  }
                }
              }
            }
          }
        },
        {
          "function": "get_list",
          "expect": [
            "api1",
            "web1",
            "web2"
          ],
          "args": [
            "config",
            "environments",
            "production",
            "servers"
          ]
        }
      ],
      "features": [
        "empty_keys"
      ],
      "behaviors": [
        "array_order_lexicographic"
      ],
      "inputs": [
        "config =\n  environments =\n    production =\n      servers =\n        = web1\n        = web2\n        = api1"
      ]
    },
    {
      "name": "bare_list_mixed_with_other_keys",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "database",
              "value": "\n  host = localhost\n  port = 5432\n  replicas =\n    = replica1\n    = replica2"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "database": {
              "host": "localhost",
              "port": "5432",
              "replicas": {
                "": [
                  "replica1",
                  "replica2"
                ]
              }
            }
          }
        },
        {
          "function": "get_list",
          "expect": [
            "replica1",
            "replica2"
          ],
          "args": [
            "database",
            "replicas"
          ]
        }
      ],
      "features": [
        "empty_keys"
      ],
      "inputs": [
        "database =\n  host = localhost\n  port = 5432\n  replicas =\n    = replica1\n    = replica2"
      ]
    },
    {
      "name": "bare_list_error_not_a_list",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "config",
              "value": "\n  setting = value"
            }
          ]
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "config": {
              "setting": "value"
            }
          }
        },
        {
          "function": "get_list",
          "expect": null,
          "args": [
            "config",
            "setting"
          ]
        }
      ],
      "behaviors": [
        "list_coercion_disabled"
      ],
      "inputs": [
        "config =\n  setting = value"
      ]
    }
  ]
}
