{
  "$schema": "../../schemas/source-format.json",
  "tests": [
    {
      "name": "basic_object_construction",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "name",
              "value": "Alice"
            },
            {
              "key": "age",
              "value": "42"
            }
          ]
        },
        {
          "function": "print",
          "expect": "name = Alice\nage = 42"
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "age": "42",
            "name": "Alice"
          }
        },
        {
          "function": "load",
          "expect": {
            "age": "42",
            "name": "Alice"
          }
        }
      ],
      "inputs": [
        "name = Alice\nage = 42"
      ]
    },
    {
      "name": "deep_nested_objects",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "server",
              "value": "\n  database =\n    host = localhost\n    port = 5432\n  cache =\n    enabled = true"
            }
          ]
        },
        {
          "function": "print",
          "expect": "server = \n  database =\n    host = localhost\n    port = 5432\n  cache =\n    enabled = true"
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "server": {
              "cache": {
                "enabled": "true"
              },
              "database": {
                "host": "localhost",
                "port": "5432"
              }
            }
          }
        },
        {
          "function": "load",
          "expect": {
            "server": {
              "cache": {
                "enabled": "true"
              },
              "database": {
                "host": "localhost",
                "port": "5432"
              }
            }
          }
        }
      ],
      "inputs": [
        "server =\n  database =\n    host = localhost\n    port = 5432\n  cache =\n    enabled = true"
      ]
    },
    {
      "name": "duplicate_keys_to_lists",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "item",
              "value": "first"
            },
            {
              "key": "item",
              "value": "second"
            },
            {
              "key": "item",
              "value": "third"
            }
          ]
        },
        {
          "function": "print",
          "expect": "item = first\nitem = second\nitem = third"
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "item": [
              "first",
              "second",
              "third"
            ]
          }
        },
        {
          "function": "load",
          "expect": {
            "item": [
              "first",
              "second",
              "third"
            ]
          }
        }
      ],
      "inputs": [
        "item = first\nitem = second\nitem = third"
      ]
    },
    {
      "name": "nested_duplicate_keys",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "config",
              "value": "\n  server = web1\n  server = web2\n  port = 80"
            }
          ]
        },
        {
          "function": "print",
          "expect": "config = \n  server = web1\n  server = web2\n  port = 80"
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "config": {
              "port": "80",
              "server": [
                "web1",
                "web2"
              ]
            }
          }
        }
      ],
      "inputs": [
        "config =\n  server = web1\n  server = web2\n  port = 80"
      ]
    },
    {
      "name": "mixed_flat_and_nested",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "name",
              "value": "Alice"
            },
            {
              "key": "config",
              "value": "\n  debug = true\n  timeout = 30"
            },
            {
              "key": "version",
              "value": "1.0"
            }
          ]
        },
        {
          "function": "print",
          "expect": "name = Alice\nconfig = \n  debug = true\n  timeout = 30\nversion = 1.0"
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "config": {
              "debug": "true",
              "timeout": "30"
            },
            "name": "Alice",
            "version": "1.0"
          }
        }
      ],
      "inputs": [
        "name = Alice\nconfig =\n  debug = true\n  timeout = 30\nversion = 1.0"
      ]
    },
    {
      "name": "nested_objects_with_lists",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "environments",
              "value": "\n  prod =\n    server = web1\n    server = web2\n    port = 80\n  dev =\n    server = localhost\n    port = 3000"
            }
          ]
        },
        {
          "function": "print",
          "expect": "environments = \n  prod =\n    server = web1\n    server = web2\n    port = 80\n  dev =\n    server = localhost\n    port = 3000"
        },
        {
          "function": "build_hierarchy",
          "expect": {
            "environments": {
              "dev": {
                "port": "3000",
                "server": "localhost"
              },
              "prod": {
                "port": "80",
                "server": [
                  "web1",
                  "web2"
                ]
              }
            }
          }
        }
      ],
      "inputs": [
        "environments =\n  prod =\n    server = web1\n    server = web2\n    port = 80\n  dev =\n    server = localhost\n    port = 3000"
      ]
    }
  ]
}
