{
  "$schema": "../../schemas/source-format.json",
  "tests": [
    {
      "name": "round_trip_basic",
      "input": "key = value\nnested =\n  sub = val",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {"key": "key", "value": "value"},
            {"key": "nested", "value": "\n  sub = val"}
          ]
        },
        {
          "function": "print",
          "expect": "key = value\nnested = \n  sub = val"
        },
        {
          "function": "round_trip",
          "expect": true
        }
      ]
    },
    {
      "name": "round_trip_whitespace_normalization",
      "input": "  key  =  value  \n  nested  = \n    sub  =  val  ",
      "tests": [
        {
          "function": "round_trip",
          "expect": true
        },
        {
          "function": "parse",
          "expect": [
            {
              "key": "key",
              "value": "value  \n  nested  = \n    sub  =  val"
            }
          ]
        }
      ],
      "features": [
        "whitespace"
      ]
    },
    {
      "name": "round_trip_empty_keys_lists",
      "input": "= item1\n= item2\nregular = value",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {"key": "", "value": "item1"},
            {"key": "", "value": "item2"},
            {"key": "regular", "value": "value"}
          ]
        },
        {
          "function": "print",
          "expect": " = item1\n = item2\nregular = value"
        },
        {
          "function": "round_trip",
          "expect": true
        }
      ],
      "features": [
        "empty_keys"
      ]
    },
    {
      "name": "round_trip_nested_structures",
      "input": "config =\n  host = localhost\n  port = 8080\n  db =\n    name = mydb\n    user = admin",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "config",
              "value": "\n  host = localhost\n  port = 8080\n  db =\n    name = mydb\n    user = admin"
            }
          ]
        },
        {
          "function": "print",
          "expect": "config = \n  host = localhost\n  port = 8080\n  db =\n    name = mydb\n    user = admin"
        },
        {
          "function": "round_trip",
          "expect": true
        }
      ]
    },
    {
      "name": "round_trip_multiline_values",
      "input": "script =\n  #!/bin/bash\n  echo hello\n  exit 0",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "script",
              "value": "\n  #!/bin/bash\n  echo hello\n  exit 0"
            }
          ]
        },
        {
          "function": "print",
          "expect": "script = \n  #!/bin/bash\n  echo hello\n  exit 0"
        },
        {
          "function": "round_trip",
          "expect": true
        }
      ],
      "features": [
        "multiline"
      ]
    },
    {
      "name": "round_trip_mixed_content",
      "input": "name = Alice\n= first item\nconfig =\n  port = 3000\n= second item\nfinal = value",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {"key": "name", "value": "Alice"},
            {"key": "", "value": "first item"},
            {"key": "config", "value": "\n  port = 3000"},
            {"key": "", "value": "second item"},
            {"key": "final", "value": "value"}
          ]
        },
        {
          "function": "print",
          "expect": "name = Alice\n = first item\nconfig = \n  port = 3000\n = second item\nfinal = value"
        },
        {
          "function": "round_trip",
          "expect": true
        }
      ],
      "features": [
        "empty_keys"
      ]
    },
    {
      "name": "round_trip_complex_nesting",
      "input": "app =\n  = item1\n  config =\n    = nested_item\n    db =\n      host = localhost\n      = db_item\n  = item2",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "app",
              "value": "\n  = item1\n  config =\n    = nested_item\n    db =\n      host = localhost\n      = db_item\n  = item2"
            }
          ]
        },
        {
          "function": "print",
          "expect": "app = \n  = item1\n  config =\n    = nested_item\n    db =\n      host = localhost\n      = db_item\n  = item2"
        },
        {
          "function": "round_trip",
          "expect": true
        }
      ],
      "features": [
        "empty_keys"
      ]
    },
    {
      "name": "round_trip_deeply_nested",
      "input": "level1 =\n  level2 =\n    level3 =\n      level4 =\n        deep = value\n        = deep_item",
      "tests": [
        {
          "function": "parse",
          "expect": [
            {
              "key": "level1",
              "value": "\n  level2 =\n    level3 =\n      level4 =\n        deep = value\n        = deep_item"
            }
          ]
        },
        {
          "function": "print",
          "expect": "level1 = \n  level2 =\n    level3 =\n      level4 =\n        deep = value\n        = deep_item"
        },
        {
          "function": "round_trip",
          "expect": true
        }
      ],
      "features": [
        "empty_keys"
      ]
    },
    {
      "name": "round_trip_empty_multiline",
      "input": "empty_section =\n\nother = value",
      "tests": [
        {
          "function": "round_trip",
          "expect": true
        },
        {
          "function": "parse",
          "expect": [
            {"key": "empty_section", "value": ""},
            {"key": "other", "value": "value"}
          ]
        },
        {
          "function": "print",
          "expect": "empty_section = \nother = value"
        }
      ],
      "features": [
        "empty_keys",
        "multiline"
      ]
    }
  ]
}
