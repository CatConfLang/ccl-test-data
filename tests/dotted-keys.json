{
  "$schema": "./schema.json",
  "suite": "CCL Dotted Key Expansion",
  "version": "1.0",
  "description": "Expanding dotted keys (e.g., 'database.host') into hierarchical structures - enables dual access patterns",
  "tests": [
    {
      "name": "basic_single_dotted_key",
      "input": "database.host = localhost",
      "expected_flat": [
        {"key": "database.host", "value": "localhost"}
      ],
      "expected_expanded": [
        {"key": "database", "value": "\n  host = localhost"}
      ],
      "expected_nested": {
        "database": {
          "host": "localhost"
        }
      },
      "meta": {"tags": ["basic", "dotted-keys", "single"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "basic_multiple_dotted_keys_same_parent",
      "input": "database.host = localhost\ndatabase.port = 5432\ndatabase.name = mydb",
      "expected_flat": [
        {"key": "database.host", "value": "localhost"},
        {"key": "database.port", "value": "5432"},
        {"key": "database.name", "value": "mydb"}
      ],
      "expected_expanded": [
        {"key": "database", "value": "\n  host = localhost\n  port = 5432\n  name = mydb"}
      ],
      "expected_nested": {
        "database": {
          "host": "localhost",
          "port": "5432",
          "name": "mydb"
        }
      },
      "meta": {"tags": ["basic", "dotted-keys", "multiple", "same-parent"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "multiple_dotted_keys_different_parents",
      "input": "database.host = localhost\nserver.port = 8080\ncache.enabled = true",
      "expected_flat": [
        {"key": "database.host", "value": "localhost"},
        {"key": "server.port", "value": "8080"},
        {"key": "cache.enabled", "value": "true"}
      ],
      "expected_expanded": [
        {"key": "database", "value": "\n  host = localhost"},
        {"key": "server", "value": "\n  port = 8080"},
        {"key": "cache", "value": "\n  enabled = true"}
      ],
      "expected_nested": {
        "database": {
          "host": "localhost"
        },
        "server": {
          "port": "8080"
        },
        "cache": {
          "enabled": "true"
        }
      },
      "meta": {"tags": ["basic", "dotted-keys", "multiple", "different-parents"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "deep_dotted_nesting_three_levels",
      "input": "app.database.host = localhost\napp.database.port = 5432",
      "expected_flat": [
        {"key": "app.database.host", "value": "localhost"},
        {"key": "app.database.port", "value": "5432"}
      ],
      "expected_expanded": [
        {"key": "app", "value": "\n  database =\n    host = localhost\n    port = 5432"}
      ],
      "expected_nested": {
        "app": {
          "database": {
            "host": "localhost",
            "port": "5432"
          }
        }
      },
      "meta": {"tags": ["deep-nesting", "dotted-keys", "three-levels"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "deep_dotted_nesting_four_levels",
      "input": "config.app.database.connection.host = localhost\nconfig.app.database.connection.timeout = 30s",
      "expected_flat": [
        {"key": "config.app.database.connection.host", "value": "localhost"},
        {"key": "config.app.database.connection.timeout", "value": "30s"}
      ],
      "expected_expanded": [
        {"key": "config", "value": "\n  app =\n    database =\n      connection =\n        host = localhost\n        timeout = 30s"}
      ],
      "expected_nested": {
        "config": {
          "app": {
            "database": {
              "connection": {
                "host": "localhost",
                "timeout": "30s"
              }
            }
          }
        }
      },
      "meta": {"tags": ["deep-nesting", "dotted-keys", "four-levels", "extreme"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "mixed_dotted_and_regular_keys",
      "input": "simple = value\ndatabase.host = localhost\nanother = test\nserver.port = 8080",
      "expected_flat": [
        {"key": "simple", "value": "value"},
        {"key": "database.host", "value": "localhost"},
        {"key": "another", "value": "test"},
        {"key": "server.port", "value": "8080"}
      ],
      "expected_expanded": [
        {"key": "simple", "value": "value"},
        {"key": "database", "value": "\n  host = localhost"},
        {"key": "another", "value": "test"},
        {"key": "server", "value": "\n  port = 8080"}
      ],
      "expected_nested": {
        "simple": "value",
        "database": {
          "host": "localhost"
        },
        "another": "test",
        "server": {
          "port": "8080"
        }
      },
      "meta": {"tags": ["mixed", "dotted-keys", "regular-keys"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "conflict_dotted_vs_nested_dotted_wins",
      "input": "database =\n  port = 3306\ndatabase.host = localhost",
      "expected_flat": [
        {"key": "database", "value": "\n  port = 3306"},
        {"key": "database.host", "value": "localhost"}
      ],
      "expected_expanded": [
        {"key": "database", "value": "\n  port = 3306\n  host = localhost"}
      ],
      "expected_nested": {
        "database": {
          "port": "3306",
          "host": "localhost"
        }
      },
      "meta": {"tags": ["conflict-resolution", "dotted-wins", "merge"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "conflict_nested_vs_dotted_merge",
      "input": "database.host = localhost\ndatabase =\n  port = 3306\n  name = mydb",
      "expected_flat": [
        {"key": "database.host", "value": "localhost"},
        {"key": "database", "value": "\n  port = 3306\n  name = mydb"}
      ],
      "expected_expanded": [
        {"key": "database", "value": "\n  host = localhost\n  port = 3306\n  name = mydb"}
      ],
      "expected_nested": {
        "database": {
          "host": "localhost",
          "port": "3306",
          "name": "mydb"
        }
      },
      "meta": {"tags": ["conflict-resolution", "merge", "order-independent"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "complex_conflict_multiple_sources",
      "input": "app.database.host = localhost\napp =\n  name = myapp\napp.database.port = 5432\napp =\n  version = 1.0",
      "expected_flat": [
        {"key": "app.database.host", "value": "localhost"},
        {"key": "app", "value": "\n  name = myapp"},
        {"key": "app.database.port", "value": "5432"},
        {"key": "app", "value": "\n  version = 1.0"}
      ],
      "expected_expanded": [
        {"key": "app", "value": "\n  database =\n    host = localhost\n    port = 5432\n  name = myapp\n  version = 1.0"}
      ],
      "expected_nested": {
        "app": {
          "database": {
            "host": "localhost",
            "port": "5432"
          },
          "name": "myapp",
          "version": "1.0"
        }
      },
      "meta": {"tags": ["complex-conflict", "multiple-sources", "merge"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "dotted_keys_with_empty_key_parent",
      "input": ".host = localhost\n.port = 8080",
      "expected_flat": [
        {"key": ".host", "value": "localhost"},
        {"key": ".port", "value": "8080"}
      ],
      "expected_expanded": [
        {"key": "", "value": "\n  host = localhost\n  port = 8080"}
      ],
      "expected_nested": {
        "": {
          "host": "localhost",
          "port": "8080"
        }
      },
      "meta": {"tags": ["empty-key", "dotted-keys", "edge-case"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "dotted_keys_with_empty_key_child",
      "input": "database. = default_value\ndatabase.host = localhost",
      "expected_flat": [
        {"key": "database.", "value": "default_value"},
        {"key": "database.host", "value": "localhost"}
      ],
      "expected_expanded": [
        {"key": "database", "value": "\n   = default_value\n  host = localhost"}
      ],
      "expected_nested": {
        "database": {
          "": "default_value",
          "host": "localhost"
        }
      },
      "meta": {"tags": ["empty-key", "dotted-keys", "trailing-dot"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "edge_case_single_dot",
      "input": ". = dot_value\nkey = normal",
      "expected_flat": [
        {"key": ".", "value": "dot_value"},
        {"key": "key", "value": "normal"}
      ],
      "expected_expanded": [
        {"key": "", "value": "\n   = dot_value"},
        {"key": "key", "value": "normal"}
      ],
      "expected_nested": {
        "": {
          "": "dot_value"
        },
        "key": "normal"
      },
      "meta": {"tags": ["edge-case", "single-dot", "empty-key"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "edge_case_multiple_consecutive_dots",
      "input": "app..config = value\ndb...host = localhost",
      "expected_flat": [
        {"key": "app..config", "value": "value"},
        {"key": "db...host", "value": "localhost"}
      ],
      "expected_expanded": [
        {"key": "app", "value": "\n   =\n    config = value"},
        {"key": "db", "value": "\n   =\n     =\n      host = localhost"}
      ],
      "expected_nested": {
        "app": {
          "": {
            "config": "value"
          }
        },
        "db": {
          "": {
            "": {
              "host": "localhost"
            }
          }
        }
      },
      "meta": {"tags": ["edge-case", "consecutive-dots", "empty-segments"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "dotted_keys_with_list_style",
      "input": "servers.production = server1\nservers.production = server2\nservers.staging = staging1",
      "expected_flat": [
        {"key": "servers.production", "value": "server1"},
        {"key": "servers.production", "value": "server2"},
        {"key": "servers.staging", "value": "staging1"}
      ],
      "expected_expanded": [
        {"key": "servers", "value": "\n  production = server1\n  production = server2\n  staging = staging1"}
      ],
      "expected_nested": {
        "servers": {
          "production": ["server1", "server2"],
          "staging": "staging1"
        }
      },
      "meta": {"tags": ["list-style", "dotted-keys", "duplicate-keys"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "dotted_keys_with_empty_key_lists",
      "input": "ports. = 8000\nports. = 8001\nports.admin = 9000",
      "expected_flat": [
        {"key": "ports.", "value": "8000"},
        {"key": "ports.", "value": "8001"},
        {"key": "ports.admin", "value": "9000"}
      ],
      "expected_expanded": [
        {"key": "ports", "value": "\n   = 8000\n   = 8001\n  admin = 9000"}
      ],
      "expected_nested": {
        "ports": {
          "": ["8000", "8001"],
          "admin": "9000"
        }
      },
      "meta": {"tags": ["empty-key", "list-style", "dotted-keys", "mixed"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "backward_compatibility_no_dots",
      "input": "database = value\nhost = localhost\nport = 5432",
      "expected_flat": [
        {"key": "database", "value": "value"},
        {"key": "host", "value": "localhost"},
        {"key": "port", "value": "5432"}
      ],
      "expected_expanded": [
        {"key": "database", "value": "value"},
        {"key": "host", "value": "localhost"},
        {"key": "port", "value": "5432"}
      ],
      "expected_nested": {
        "database": "value",
        "host": "localhost",
        "port": "5432"
      },
      "meta": {"tags": ["backward-compatibility", "no-dots", "unchanged"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "backward_compatibility_nested_syntax",
      "input": "database =\n  host = localhost\n  port = 5432",
      "expected_flat": [
        {"key": "database", "value": "\n  host = localhost\n  port = 5432"}
      ],
      "expected_expanded": [
        {"key": "database", "value": "\n  host = localhost\n  port = 5432"}
      ],
      "expected_nested": {
        "database": {
          "host": "localhost",
          "port": "5432"
        }
      },
      "meta": {"tags": ["backward-compatibility", "nested-syntax", "unchanged"], "level": 3, "feature": "dotted-keys"}
    },
    {
      "name": "stress_test_complex_mixed_scenario",
      "input": "/ = CCL with dotted keys\napp.name = MyApp\napp.version = 1.0\n\ndatabase =\n  enabled = true\n\ndatabase.connection.host = localhost\ndatabase.connection.port = 5432\ndatabase.pool.size = 10\n\nservers.web = server1\nservers.web = server2\nservers.api.endpoint = /api/v1\n\nconfig.debug = true\nconfig =\n  env = production",
      "expected_flat": [
        {"key": "/", "value": "CCL with dotted keys"},
        {"key": "app.name", "value": "MyApp"},
        {"key": "app.version", "value": "1.0"},
        {"key": "database", "value": "\n  enabled = true"},
        {"key": "database.connection.host", "value": "localhost"},
        {"key": "database.connection.port", "value": "5432"},
        {"key": "database.pool.size", "value": "10"},
        {"key": "servers.web", "value": "server1"},
        {"key": "servers.web", "value": "server2"},
        {"key": "servers.api.endpoint", "value": "/api/v1"},
        {"key": "config.debug", "value": "true"},
        {"key": "config", "value": "\n  env = production"}
      ],
      "expected_expanded": [
        {"key": "/", "value": "CCL with dotted keys"},
        {"key": "app", "value": "\n  name = MyApp\n  version = 1.0"},
        {"key": "database", "value": "\n  enabled = true\n  connection =\n    host = localhost\n    port = 5432\n  pool =\n    size = 10"},
        {"key": "servers", "value": "\n  web = server1\n  web = server2\n  api =\n    endpoint = /api/v1"},
        {"key": "config", "value": "\n  debug = true\n  env = production"}
      ],
      "expected_nested": {
        "/": "CCL with dotted keys",
        "app": {
          "name": "MyApp",
          "version": "1.0"
        },
        "database": {
          "enabled": "true",
          "connection": {
            "host": "localhost",
            "port": "5432"
          },
          "pool": {
            "size": "10"
          }
        },
        "servers": {
          "web": ["server1", "server2"],
          "api": {
            "endpoint": "/api/v1"
          }
        },
        "config": {
          "debug": "true",
          "env": "production"
        }
      },
      "meta": {"tags": ["stress-test", "complex", "mixed", "real-world"], "level": 3, "feature": "dotted-keys"}
    }
  ]
}